{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="stylesheet" href="{% static 'pong/css/style.css' %}">
	<title>Transcendence</title>
</head>

<body>
	
	<!-- Header content -->
	<header>
		<nav>
			{% if not user.is_authenticated %}
			<button id="registration-button">Registration</button>
			<button id="login-button">Log in</button>
			{% endif %}
			{% if user.is_authenticated %}
			<a href="{% url 'pong:logout' %}">
				<button id="logout-button">Log out</button>
			</a>
			<button id="profile-button">Profile</button>
			{% endif %}
		</nav>
	</header>
	
	<!-- Main content -->
	<main>
		<div id="app" class="app">
			<!-- SPA container -->
			{% if not user.is_authenticated %}
			<div id="form-section" class="content form"></div>
			{% else %}
			<div id="data" class="content"></div>
			{% endif %}
			<div id="game" class="content game"></div>
			<div id="chat" class="chat content"></div>
		</div>
	</main>
	<!-- Footer content -->
	<footer>
		<p class="rigths">&copy; 2024 Transcendence. All rights reserved.</p>
	</footer>
	{% if user.is_authenticated %}
	<script type="importmap">
		{
			"imports": {
				"three": "https://unpkg.com/three@0.160.0/build/three.module.js",
				"three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
			}
		}
	</script>
	<script>
		window.staticUrl = "{% static 'pong/' %}"
	</script>
	<script src = "{% static 'pong/js/pong.js' %}" type="module"></script>
	{% endif %}
	<script src="{% static 'pong/js/profile.js' %}"></script>
	<script src="{% static 'pong/js/registration.js' %}"></script>
	<script src="{% static 'pong/js/login.js' %}"></script>
	<script>
		const socket = new WebSocket("wss://localhost/ws/chat/")

		socket.addEventListener('open', function (event) {
			console.log('Connected to WebSocket server');
			socket.send('First connection');
		});
		
		// Event listener for receiving messages from the server
		socket.addEventListener('message', function (event) {
			console.log('Message from server:', event.data);
		});
		
		// Event listener for handling errors
		socket.addEventListener('error', function (event) {
			console.error('WebSocket error:', event);
		});
		
		// Event listener for handling the connection close
		socket.addEventListener('close', function (event) {
			console.log('Connection closed');
		});
	</script>
</body>
</html>